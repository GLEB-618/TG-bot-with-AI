# ü§ñ TG-bot-with-AI

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –∫–∞—Å—Ç–æ–º–Ω–æ–π —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏, –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –Ω–∞ —Å—Ç–∏–ª–µ –æ–±—â–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ (–°–∞–≤–≤—á–∏–∫–∞). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `transformers`, `PEFT`, `LoRA` –∏ 4-–±–∏—Ç–Ω–æ–µ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ GPU —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é.

---

## üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Å—Ç–∏–ª–µ –°–∞–≤–≤—á–∏–∫–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram —á–µ—Ä–µ–∑ `aiogram`
- –î–æ–æ–±—É—á–µ–Ω–∏–µ LLM —Å –ø–æ–º–æ—â—å—é LoRA
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 4bit –º–æ–¥–µ–ª–∏ (—á–µ—Ä–µ–∑ `bitsandbytes`)
- Callback'–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ (loss, perplexity)

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ bot/                    # Telegram-–±–æ—Ç (–Ω–∞ aiogram)
‚îÇ   ‚îú‚îÄ‚îÄ handlers/           # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îú‚îÄ‚îÄ model/                  # –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ shared/                 # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã, –ø—É—Ç–∏, –ª–æ–≥–≥–µ—Ä—ã
‚îú‚îÄ‚îÄ training/               # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ LoRA
‚îÇ   ‚îú‚îÄ‚îÄ train.py            # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–æ–æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ prepare_data.py     # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ callbacks.py        # Callbacks –¥–ª—è –ª–æ–≥–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

> –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: Python 3.10+, `torch` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA, `transformers`, `peft`, `bitsandbytes`

---

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–π `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```
BOT_TOKEN=—Ç–≤–æ–π_—Ç–≥_—Ç–æ–∫–µ–Ω
```

---

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python src/training/train.py
```

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç –∏–∑ `data/processed/`
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —á–µ–∫–ø–æ–∏–Ω—Ç—ã –≤ `models/checkpoints/`
- –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å ‚Äî –≤ `models/final_model_v*/`

---

### 4. –ó–∞–ø—É—Å–∫ Telegram-–±–æ—Ç–∞

```bash
python src/bot/main.py
```

- –û—Ç–≤–µ—Ç—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ –¥–æ–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–∞–Ω–¥ `/start`, `/reset`, –∫–∞—Å—Ç–æ–º–Ω—ã–π —á–∞—Ç

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏

- `eval_loss` –∏ `perplexity` –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏
- –ß–µ–∫–ø–æ–∏–Ω—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `logs/train.log`

---

## üõ† –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- [Transformers](https://github.com/huggingface/transformers)
- [PEFT](https://github.com/huggingface/peft)
- [BitsAndBytes](https://github.com/TimDettmers/bitsandbytes)
- [Aiogram](https://github.com/aiogram/aiogram)

---

## üß† –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å Telegram-–±–æ—Ç–∞, —Å–ø–æ—Å–æ–±–Ω–æ–≥–æ –æ–±—â–∞—Ç—å—Å—è –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ ‚Äî –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∏–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –∏–∑ Telegram-–∏—Å—Ç–æ—Ä–∏–∏, —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –∏–Ω—Ç–æ–Ω–∞—Ü–∏–π, —Ñ—Ä–∞–∑ –∏ —ç–º–æ—Ü–∏–π.

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License